# Excel合并工具 - 打包说明

## 概述
本文档说明如何将Excel合并工具打包成可执行文件，方便在没有Python环境的机器上运行。

## 环境要求

### 开发环境
- Python 3.7+
- 所有依赖包（见requirements.txt）

### 打包工具
- PyInstaller 5.0+

## 打包步骤

### 1. 安装依赖
```bash
pip install -r requirements.txt
pip install pyinstaller
```

### 2. 准备打包
确保以下文件和目录存在：
- `run.py` - 主启动文件
- `config/` - 配置目录
- `AI比赛测试数据/` - 测试数据目录
- `output/` - 输出目录

### 3. 执行打包

#### Windows系统
```cmd
build.bat
```

#### Linux/Mac系统
```bash
chmod +x build.sh
./build.sh
```

#### 手动打包
```bash
pyinstaller build_exe.spec
```

## 打包配置说明

### build_exe.spec 配置项

1. **入口文件**: `run.py`
2. **数据文件**: 
   - `config/` - 配置文件目录
   - `AI比赛测试数据/` - 测试数据目录
   - `output/` - 输出目录
3. **隐藏导入**: 包含所有必要的Python模块
4. **控制台**: 设置为False，创建GUI应用

### 输出文件
- **Windows**: `dist/Excel合并工具.exe`
- **Linux/Mac**: `dist/Excel合并工具`

## 测试打包结果

### 1. 基本功能测试
1. 运行可执行文件
2. 测试文件导入功能
3. 测试字段映射功能
4. 测试合并功能

### 2. 数据完整性测试
1. 验证配置文件是否正确包含
2. 验证测试数据是否可访问
3. 验证输出目录是否可写

## 分发说明

### 文件结构
```
Excel合并工具/
├── Excel合并工具.exe (Windows) 或 Excel合并工具 (Linux/Mac)
├── config/ (配置文件目录)
├── AI比赛测试数据/ (测试数据)
└── output/ (输出目录)
```

### 系统要求
- **Windows**: Windows 7+ (64位)
- **Linux**: Ubuntu 18.04+ 或其他主流发行版
- **Mac**: macOS 10.14+

### 运行要求
- 无需安装Python环境
- 无需安装额外依赖包
- 需要足够的磁盘空间（约200MB）

## 常见问题

### 1. 打包失败
- 检查Python版本是否兼容
- 检查所有依赖是否正确安装
- 检查文件路径是否正确

### 2. 运行时错误
- 检查数据文件是否正确包含
- 检查配置文件是否存在
- 检查输出目录权限

### 3. 性能问题
- 打包后的程序启动可能较慢
- 首次运行需要解压临时文件
- 建议在SSD上运行以获得更好性能

## 优化建议

### 1. 减小文件大小
- 移除不必要的依赖
- 使用UPX压缩（已启用）
- 排除不需要的模块

### 2. 提高启动速度
- 使用--onedir模式（默认）
- 预编译Python字节码
- 优化导入顺序

### 3. 增强稳定性
- 添加错误处理
- 提供详细的日志记录
- 实现自动更新机制

## 版本管理

### 版本号规则
- 主版本号：重大功能更新
- 次版本号：功能改进
- 修订号：Bug修复

### 发布流程
1. 更新版本号
2. 执行完整测试
3. 打包程序
4. 测试打包结果
5. 发布到目标平台

## 技术支持

如有问题，请检查：
1. 系统兼容性
2. 文件权限
3. 依赖完整性
4. 配置正确性

更多技术支持请参考项目文档或联系开发团队。
